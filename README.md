# FundVision - åŸºé‡‘ä¼°å€¼ä¸å›æ’¤åˆ†æç³»ç»Ÿ

<div align="center">

**åŸºäº Flask çš„æ™ºèƒ½åŸºé‡‘åˆ†æå¹³å°**

å®æ—¶ä¼°å€¼ Â· å›æ’¤åˆ†æ Â· å‡€å€¼å›¾è¡¨ Â· AI è§£æ Â· å¤šä¸»é¢˜é€‚é…

</div>

---

## âœ¨ æ ¸å¿ƒåŠŸèƒ½

### ğŸ“Š æ•°æ®åˆ†æ
- **å®æ—¶ä¼°å€¼** - ä¼°ç®—åŸºé‡‘å½“æ—¥æ¶¨è·Œå¹…ï¼ŒæŒæ¡ç›˜ä¸­åŠ¨æ€
- **90æ—¥é«˜ç‚¹å›æ’¤** - åˆ†æåŸºé‡‘è·ç¦»è¿‘æœŸé«˜ç‚¹çš„å›æ’¤å¹…åº¦
- **é£é™©æŒ‡æ ‡** - å¤æ™®æ¯”ç‡ã€å¹´åŒ–æ³¢åŠ¨ç‡ã€æœ€å¤§å›æ’¤ã€åŒç±»æ’å
- **å‡€å€¼èµ°åŠ¿å›¾è¡¨** - ECharts å¯è§†åŒ–å†å²å‡€å€¼æ›²çº¿ï¼Œæ”¯æŒ 1/2/3/6/12 ä¸ªæœˆå‘¨æœŸåˆ‡æ¢ï¼ŒåŒºé—´ç»Ÿè®¡ä¸€ç›®äº†ç„¶

### ğŸ¤– æ™ºèƒ½äº¤äº’
- **AI æ™ºèƒ½è§£æ** - è‡ªç„¶è¯­è¨€è¾“å…¥ï¼Œè‡ªåŠ¨è¯†åˆ«åŸºé‡‘ä»£ç å’ŒæŒä»“
- **æ¨¡ç³Šæœç´¢** - æ”¯æŒä»£ç /åç§°/æ‹¼éŸ³æœç´¢ï¼Œå•å­—ç¬¦ä¹Ÿèƒ½å¿«é€Ÿå®šä½
- **æ··åˆè¾“å…¥** - AI è§£æä¸æ‰‹åŠ¨æœç´¢æ— ç¼åä½œ

### ï¿½ ç”¨æˆ·ä½“éªŒ
- **æ·±è‰²/æµ…è‰²ä¸»é¢˜** - ä¸€é”®åˆ‡æ¢ï¼Œå¹³æ»‘è¿‡æ¸¡åŠ¨ç”»
- **å“åº”å¼è®¾è®¡** - å®Œç¾é€‚é…æ¡Œé¢ç«¯ä¸ç§»åŠ¨ç«¯
- **Toast é€šçŸ¥** - ä¼˜é›…çš„æ¶ˆæ¯æç¤ºç³»ç»Ÿ
- **æœ¬åœ°ç¼“å­˜** - åŸºé‡‘åˆ—è¡¨è‡ªåŠ¨ä¿å­˜ï¼Œåˆ·æ–°ä¸ä¸¢å¤±

### âš¡ æ€§èƒ½è¡¨ç°
- **å¹¶è¡Œåˆ†æ** - çº¿ç¨‹æ± å¹¶è¡Œå¤„ç†ï¼Œå¤šåŸºé‡‘åˆ†æé€Ÿåº¦å€å¢
- **å®æ—¶æŒ‡æ•°** - å·¦ä¾§è¾¹æ æ˜¾ç¤ºä¸»è¦æŒ‡æ•°æ¶¨è·Œå¹…

---

## ğŸ›  æŠ€æœ¯æ ˆ

| ç±»åˆ« | æŠ€æœ¯ |
|------|------|
| åç«¯ | Flask + Flask-CORS + Flask-Limiter |
| å‰ç«¯ | åŸç”Ÿ HTML + Tailwind CSS + GSAP + ECharts |
| æ•°æ® | akshare + pandas |
| AI | DeepSeek / OpenAI / Claude / Gemini / Ollama |

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–

```bash
git clone https://github.com/ä½ çš„ç”¨æˆ·å/fund.git
cd fund
pip install -r requirements.txt
```

### 2. é…ç½®ç¯å¢ƒå˜é‡

```bash
cp .env.example .env
```

ç¼–è¾‘ `.env` æ–‡ä»¶ï¼š

```env
AI_PROVIDER=deepseek
AI_API_KEY=your_api_key_here
```

### 3. å¯åŠ¨æœåŠ¡

**åŒå‡» `run.bat`** è‡ªåŠ¨å¯åŠ¨åç«¯å¹¶æ‰“å¼€å‰ç«¯é¡µé¢

æˆ–æ‰‹åŠ¨è¿è¡Œï¼š

```bash
python app.py
```

- åç«¯ API: `http://localhost:5000`
- å‰ç«¯ç•Œé¢: æ‰“å¼€ `index.html`

---

## ğŸ“– ä½¿ç”¨æŒ‡å—

### AI æ™ºèƒ½è§£æ
ç²˜è´´ä»»æ„æ ¼å¼çš„æŒä»“æè¿°ï¼ŒAI è‡ªåŠ¨è¯†åˆ«ï¼š

```
æ˜“æ–¹è¾¾è“ç­¹ç²¾é€‰æ··åˆ 110011 10000å…ƒ
æˆ‘ä¹°äº†20000å—çš„ç™½é…’åŸºé‡‘ï¼Œä»£ç æ˜¯012414
012414,15000
```

### åŸºé‡‘è¯¦æƒ…
ç‚¹å‡»åŸºé‡‘å¡ç‰‡è¿›å…¥è¯¦æƒ…é¡µï¼ŒæŸ¥çœ‹ï¼š
- ğŸ“‹ æŒä»“æ˜ç»†ä¸æ¶¨è·Œå¹…
- ğŸ“ˆ å‡€å€¼èµ°åŠ¿å›¾è¡¨ï¼ˆæ”¯æŒå¤šå‘¨æœŸåˆ‡æ¢ï¼‰
- ğŸ“Š åŒºé—´æœ€é«˜/æœ€ä½å‡€å€¼ã€æ”¶ç›Šç‡ç»Ÿè®¡

### ä¸»é¢˜åˆ‡æ¢
ç‚¹å‡»é¡¶éƒ¨æŒ‰é’®åˆ‡æ¢æ·±è‰²/æµ…è‰²æ¨¡å¼ï¼Œè®¾ç½®è‡ªåŠ¨ä¿å­˜

---

## ğŸ”Œ API æ¥å£

### æ¥å£åˆ—è¡¨

| æ¥å£ | æ–¹æ³• | è¯´æ˜ | é™æµ |
|------|------|------|------|
| `/api/health` | GET | å¥åº·æ£€æŸ¥ | æ—  |
| `/api/search_fund` | GET | åŸºé‡‘æœç´¢ï¼ˆæ”¯æŒä»£ç /åç§°/æ‹¼éŸ³ï¼‰ | 60/min |
| `/api/fund_info/<code>` | GET | åŸºé‡‘åŸºæœ¬ä¿¡æ¯ | 60/min |
| `/api/parse_funds` | POST | AI è§£æè‡ªç„¶è¯­è¨€ | 10/min |
| `/api/fund_analysis` | POST | å®Œæ•´åˆ†æï¼ˆä¼°å€¼+å›æ’¤+é£é™©æŒ‡æ ‡ï¼‰ | 20/min |
| `/api/estimate` | POST | ä»…ä¼°å€¼ | 30/min |
| `/api/drawdown` | POST | ä»…å›æ’¤åˆ†æ | 30/min |
| `/api/get_indices` | GET | å®æ—¶æŒ‡æ•°æ¶¨è·Œå¹… | 30/min |
| `/api/get_fund_detail` | GET | åŸºé‡‘æŒä»“è¯¦æƒ…ï¼ˆå«è‚¡ç¥¨æ¶¨è·Œå¹…ï¼‰ | 10/min |
| `/api/get_nav_history` | GET | å•åªåŸºé‡‘å†å²å‡€å€¼æ•°æ® | 30/min |
| `/api/get_nav_history_batch` | GET | æ‰¹é‡è·å–å†å²å‡€å€¼æ•°æ®ï¼ˆæœ€å¤š4åªï¼‰ | 20/min |

---

### 1. å¥åº·æ£€æŸ¥

```bash
GET /api/health
```

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
  "status": "ok",
  "version": "6.4 Compare-Edition",
  "time": "2026-02-12T10:30:00",
  "modules": ["estimate", "drawdown", "fund_analysis", "ai_parse", "fund_search", "nav_history", "nav_history_batch"],
  "default_window": "90d",
  "ai_enabled": true,
  "ai_provider": {"provider": "deepseek", "model": "deepseek-chat", "configured": true}
}
```

---

### 2. åŸºé‡‘æœç´¢

```bash
GET /api/search_fund?keyword=ç™½é…’&limit=10
```

**å‚æ•°ï¼š**
- `keyword` (å¿…å¡«): æœç´¢å…³é”®è¯ï¼Œè‡³å°‘2ä¸ªå­—ç¬¦
- `limit` (å¯é€‰): è¿”å›æ•°é‡ï¼Œé»˜è®¤10ï¼Œæœ€å¤§20

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
  "success": true,
  "keyword": "ç™½é…’",
  "results": [
    {"code": "161725", "name": "æ‹›å•†ä¸­è¯ç™½é…’æŒ‡æ•°(LOF)A", "pinyin": "ZSZSBZJ", "type": "è‚¡ç¥¨å‹"},
    {"code": "012414", "name": "æ‹›å•†ä¸­è¯ç™½é…’æŒ‡æ•°C", "pinyin": "ZSZSBZJ", "type": "è‚¡ç¥¨å‹"}
  ],
  "count": 2
}
```

---

### 3. åŸºé‡‘åŸºæœ¬ä¿¡æ¯

```bash
GET /api/fund_info/110011
```

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
  "success": true,
  "fund": {
    "code": "110011",
    "name": "æ˜“æ–¹è¾¾ä¸­å°ç›˜æ··åˆ",
    "pinyin": "YFDZXP",
    "type": "æ··åˆå‹"
  }
}
```

---

### 4. AI è§£æè‡ªç„¶è¯­è¨€

```bash
POST /api/parse_funds
Content-Type: application/json

{"text": "æ˜“æ–¹è¾¾è“ç­¹10000å…ƒï¼Œ012414ç™½é…’åŸºé‡‘20000å—"}
```

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
  "success": true,
  "funds": [
    {"code": "005827", "name": "æ˜“æ–¹è¾¾è“ç­¹ç²¾é€‰æ··åˆ", "holding": 10000},
    {"code": "012414", "name": "æ‹›å•†ä¸­è¯ç™½é…’æŒ‡æ•°C", "holding": 20000}
  ],
  "count": 2
}
```

---

### 5. åŸºé‡‘å®Œæ•´åˆ†æ

```bash
POST /api/fund_analysis
Content-Type: application/json

{
  "funds": [
    {"code": "110011", "name": "æ˜“æ–¹è¾¾è“ç­¹", "holding": 10000}
  ]
}
```

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
  "summary": {
    "total_funds": 1,
    "analyzed_successfully": 1,
    "timestamp": "2026-02-12T10:30:00"
  },
  "detailed_results": [{
    "fund_code": "110011",
    "fund_name": "æ˜“æ–¹è¾¾è“ç­¹ç²¾é€‰æ··åˆ",
    "holding": 10000,
    "real_time_estimate": {
      "today_change_pct": 0.25,
      "estimated_nav": 5.35,
      "market": "Aè‚¡",
      "benchmark": "æ²ªæ·±300",
      "update_time": "14:30:00"
    },
    "historical_drawdown": {
      "yesterday_nav": 5.34,
      "rolling_high_90d": 5.65,
      "high_date": "2026-01-28",
      "drawdown_to_high_pct": -5.41,
      "is_at_rolling_high": false
    },
    "synthetic_forecast": {
      "estimated_drawdown_pct": -5.16,
      "drawdown_change_today": 0.25
    },
    "risk_metrics": {
      "sharpe_ratio": 1.49,
      "annual_volatility": 22.52,
      "max_drawdown": -12.48,
      "rank_1y": "47",
      "rank_3y": "32",
      "rank_5y": "28"
    }
  }]
}
```

---

### 6. ä»…ä¼°å€¼

```bash
POST /api/estimate
Content-Type: application/json

{
  "funds": [
    {"code": "110011", "name": "æ˜“æ–¹è¾¾è“ç­¹", "holding": 10000}
  ]
}
```

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
  "results": [{
    "fund_code": "110011",
    "fund_name": "æ˜“æ–¹è¾¾è“ç­¹ç²¾é€‰æ··åˆ",
    "market": "Aè‚¡",
    "holding": 10000,
    "benchmark": "æ²ªæ·±300",
    "benchmark_change": 0.35,
    "estimate_change": 0.25,
    "profit": 25.0,
    "top10_ratio": 45.2,
    "position_ratio": 90.0,
    "persistence": 0.55,
    "update_time": "14:30:00"
  }],
  "summary": {
    "total_holding": 10000,
    "total_profit": 25.0,
    "portfolio_change": 0.25
  }
}
```

---

### 7. ä»…å›æ’¤åˆ†æ

```bash
POST /api/drawdown
Content-Type: application/json

{
  "funds": [{"code": "110011"}],
  "rolling_days": 90
}
```

**å‚æ•°ï¼š**
- `rolling_days`: å›æ’¤çª—å£æœŸï¼Œæ”¯æŒ 30/60/90/120/250 å¤©ï¼Œé»˜è®¤90

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
  "rolling_window": "90æ—¥",
  "results": [{
    "fund_code": "110011",
    "current_nav": 5.34,
    "current_date": "2026-02-11",
    "rolling_high": 5.65,
    "high_date": "2026-01-28",
    "drawdown_pct": -5.41,
    "distance_from_high": -0.31,
    "data_points": 90,
    "is_at_high": false
  }],
  "count": 1
}
```

---

### 8. å®æ—¶æŒ‡æ•°æ¶¨è·Œå¹…

```bash
GET /api/get_indices
```

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
  "success": true,
  "indices": [
    {"name": "åˆ›ä¸šæ¿æŒ‡", "code": "sz399006", "change": 1.25},
    {"name": "æ²ªæ·±300", "code": "sz399300", "change": 0.35},
    {"name": "ä¸­è¯500", "code": "sh000905", "change": 0.52},
    {"name": "ä¸Šè¯æŒ‡æ•°", "code": "sh000001", "change": 0.28},
    {"name": "çº³æ–¯è¾¾å…‹100", "code": "usQQQ", "change": -0.15},
    {"name": "æ’ç”ŸæŒ‡æ•°", "code": "hkHSI", "change": 0.45}
  ],
  "timestamp": "2026-02-12 10:30:00"
}
```

---

### 9. åŸºé‡‘æŒä»“è¯¦æƒ…

```bash
GET /api/get_fund_detail?code=110011
```

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
  "success": true,
  "fund_code": "110011",
  "holdings": [
    {"code": "600519", "name": "è´µå·èŒ…å°", "ratio": 8.52, "change": 1.25, "contribution": 0.107},
    {"code": "000858", "name": "äº”ç²®æ¶²", "ratio": 7.35, "change": 0.85, "contribution": 0.062}
  ],
  "total_ratio": 45.2,
  "remaining_ratio": 44.8,
  "benchmark": "æ²ªæ·±300",
  "benchmark_change": 0.35,
  "total_change": 0.25,
  "calculation_method": "åŠ æƒå¹³å‡: æŒä»“è‚¡ç¥¨æ¶¨è·Œå¹… Ã— å æ¯” + å‰©ä½™éƒ¨åˆ†ä½¿ç”¨åŸºå‡†æŒ‡æ•°æ¶¨è·Œå¹…",
  "timestamp": "14:30:00"
}
```

---

### 10. å•åªåŸºé‡‘å†å²å‡€å€¼

```bash
GET /api/get_nav_history?code=110011&days=90
```

**å‚æ•°ï¼š**
- `code` (å¿…å¡«): åŸºé‡‘ä»£ç 
- `days` (å¯é€‰): å¤©æ•°ï¼Œæ”¯æŒ 30/60/90/180/365ï¼Œé»˜è®¤90

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
  "success": true,
  "fund_code": "110011",
  "days": 90,
  "data": {
    "dates": ["2025-11-15", "2025-11-16", "..."],
    "navs": [5.21, 5.23, "..."]
  },
  "statistics": {
    "max_nav": 5.65,
    "max_date": "2026-01-28",
    "min_nav": 5.01,
    "min_date": "2025-12-20",
    "current_nav": 5.34,
    "total_return": 2.50,
    "data_points": 90
  },
  "timestamp": "2026-02-12 10:30:00"
}
```

---

### 11. æ‰¹é‡è·å–å†å²å‡€å€¼

```bash
GET /api/get_nav_history_batch?codes=110011,012414,161725&days=180
```

**å‚æ•°ï¼š**
- `codes` (å¿…å¡«): åŸºé‡‘ä»£ç ï¼Œé€—å·åˆ†éš”ï¼Œæœ€å¤š4åª
- `days` (å¯é€‰): å¤©æ•°ï¼Œæ”¯æŒ 30/90/180/365ï¼Œé»˜è®¤180

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
  "success": true,
  "funds": [
    {
      "code": "110011",
      "data": {"dates": ["..."], "navs": [...]},
      "statistics": {"max_nav": 5.65, "min_nav": 5.01, "current_nav": 5.34, "total_return": 2.50, "data_points": 180}
    }
  ],
  "days": 180,
  "count": 3,
  "timestamp": "2026-02-12 10:30:00"
}
```

---

## ğŸ¤– æ”¯æŒçš„ AI æä¾›å•†

| æä¾›å•† | AI_PROVIDER å€¼ |
|--------|----------------|
| DeepSeek | `deepseek` |
| OpenAI | `openai` |
| Azure OpenAI | `azure_openai` |
| Claude | `anthropic` |
| Gemini | `gemini` |
| Ollama | `ollama` |
| è‡ªå®šä¹‰å…¼å®¹ API | `openai_compatible` |

---

## â˜ï¸ éƒ¨ç½²

### Railway / Render

1. Fork æœ¬é¡¹ç›®
2. è¿æ¥ GitHub ä»“åº“
3. è®¾ç½®ç¯å¢ƒå˜é‡ `AI_PROVIDER` å’Œ `AI_API_KEY`
4. è‡ªåŠ¨éƒ¨ç½²å®Œæˆ

### å‰ç«¯éƒ¨ç½²

çº¯é™æ€ HTMLï¼Œå¯éƒ¨ç½²è‡³ GitHub Pages / Vercel / Netlify

ä¿®æ”¹ `index.html` ä¸­çš„ `API_BASE_URL` æŒ‡å‘åç«¯åœ°å€

---

## âš ï¸ å…è´£å£°æ˜

- æœ¬é¡¹ç›®ä»…ä¾›å­¦ä¹ äº¤æµï¼Œä¸æ„æˆä»»ä½•æŠ•èµ„å»ºè®®
- åŸºé‡‘æ•°æ®æ¥æºäº akshareï¼Œä»…ä¾›å‚è€ƒ
- æŠ•èµ„æœ‰é£é™©ï¼Œå…¥å¸‚éœ€è°¨æ…

---

## License

MIT
